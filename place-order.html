<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Place Order - QuickBite</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .fade-in { animation: fadeIn 200ms ease-out forwards; }
    .fade-out { animation: fadeOut 200ms ease-in forwards; }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    @keyframes fadeOut {
      from { opacity: 1; transform: scale(1); }
      to { opacity: 0; transform: scale(0.95); }
    }
    .overlay-fade-in { animation: overlayFadeIn 200ms ease-out forwards; }
    .overlay-fade-out { animation: overlayFadeOut 200ms ease-in forwards; }
    @keyframes overlayFadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes overlayFadeOut { from { opacity: 1; } to { opacity: 0; } }
  </style>
</head>
<body class="bg-[#FFFAF0] min-h-screen font-sans">

  <div class="max-w-5xl mx-auto p-4">
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
      <button>
        <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" stroke-width="2"
          viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>
      <h2 class="text-lg md:text-xl font-semibold text-center flex-1 -ml-6">
        Hi <span id="firstName">John</span>,<br class="block sm:hidden" />
        What can we get for you today?
      </h2>
      <button>
        <svg class="w-6 h-6 text-gray-800" fill="none" stroke="currentColor" stroke-width="2"
          viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M5.121 17.804A10.97 10.97 0 0112 15c2.042 0 3.937.612 5.51 1.651M15 10a3 3 0 11-6 0 3 3 0 016 0z"/>
        </svg>
      </button>
    </div>

    <!-- Categories -->
    <div id="categories" class="space-y-6">

      <!-- Dynamically built with JS -->
    </div>
  </div>

  <!-- Cart Tab -->
<div id="cartTab" onclick="openCartDrawer()"
     class="fixed bottom-[-4rem] left-1/2 -translate-x-1/2 bg-red-500 text-white px-6 py-3 rounded-full shadow-lg text-sm font-semibold transition-all duration-300 z-40 cursor-pointer">
  View Cart (0)
</div>


  <!-- Modal -->
  <div id="modalOverlay"
       class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div id="modalContent"
         class="bg-white rounded-2xl p-4 w-11/12 max-w-sm fade-in"
         onclick="event.stopPropagation()">
      <button onclick="hideModal()" class="text-gray-600 mb-2">✕</button>
      <img id="modalImg" src="" alt="food" class="rounded-lg mb-3 w-full" />
      <h3 class="text-lg font-semibold mb-1" id="modalTitle">Item Name</h3>
      <p class="text-sm text-gray-600 mb-2" id="modalDesc">Description here</p>
      <p class="text-md font-bold text-red-500 mb-4" id="modalPrice">$0.00</p>
      
      <!-- old "Add to Order" button -->
      <!-- <div class="flex items-center space-x-2">
        <button class="bg-red-100 text-red-600 px-3 py-1 rounded-full"
                onclick="adjustQty(-1)">–</button>
        <span id="modalQty">1</span>
        <button class="bg-red-100 text-red-600 px-3 py-1 rounded-full"
                onclick="adjustQty(1)">+</button>
        <button class="ml-auto bg-red-500 text-white px-4 py-2 rounded-full">
          Add to Order
        </button>
      </div> -->


      <!-- Adjusted 'add to cart' options -->

       <div class="flex items-center space-x-2 justify-center">
        <button class="bg-red-100 text-red-600 px-3 py-1 rounded-full"
          onclick="adjustQty(-1)">–</button>
        <span id="modalQty">1</span>
        <button class="bg-red-100 text-red-600 px-3 py-1 rounded-full"
          onclick="adjustQty(1)">+</button>
        </div>


    </div>
  </div>

  <script>
    const starterData = [
      { id: 0, name: 'Mozzarella Sticks', desc: 'Crispy and cheesy.', price: 5.99, img: 'https://source.unsplash.com/80x80/?cheese' },
      { id: 1, name: 'Spring Rolls', desc: 'Fresh veggies inside.', price: 4.50, img: 'https://source.unsplash.com/80x80/?rolls' },
    ];
    const entreeData = [
      { id: 10, name: 'Grilled Chicken', desc: 'With roasted veggies.', price: 12.99, img: 'https://source.unsplash.com/80x80/?chicken' },
    ];
    const dessertData = [
      { id: 20, name: 'Chocolate Cake', desc: 'Rich and moist.', price: 6.00, img: 'https://source.unsplash.com/80x80/?cake' },
    ];
    const drinkData = [
      { id: 30, name: 'Iced Tea', desc: 'Cool and refreshing.', price: 2.50, img: 'https://source.unsplash.com/80x80/?tea' },
    ];
    const cart = {};
    const allCategories = [
      { id: 'starters', label: 'Starters', items: starterData },
      { id: 'entrees', label: 'Entrees', items: entreeData },
      { id: 'desserts', label: 'Desserts', items: dessertData },
      { id: 'drinks', label: 'Drinks', items: drinkData }
    ];

    const categoriesContainer = document.getElementById('categories');

    allCategories.forEach(category => {
      const wrapper = document.createElement('div');
      wrapper.innerHTML = `
        <div class="bg-red-50 rounded-md p-3 hover:bg-red-100 transition cursor-pointer flex justify-between items-center"
             onclick="toggleCategory('${category.id}')">
          <h3 class="text-base md:text-lg font-semibold">${category.label}</h3>
          <span class="text-xl">⌄</span>
        </div>
        <div id="${category.id}" class="hidden mt-2">
          <div class="flex space-x-4 overflow-x-auto pb-2" id="${category.id}-items"></div>
        </div>
      `;
      categoriesContainer.appendChild(wrapper);

      const container = document.getElementById(`${category.id}-items`);
      category.items.forEach(item => {
        const card = document.createElement('div');
        card.className = 'relative w-28 md:w-32 lg:w-36 text-center flex-shrink-0';
        card.innerHTML = `
          <div id="badge-${item.id}" class="absolute top-0 left-0 bg-black text-white text-xs px-2 py-0.5 rounded-full z-10 hidden">1</div>
          <img src="${item.img}" class="mx-auto rounded-full w-20 h-20 md:w-24 md:h-24 lg:w-28 lg:h-28 border-2 border-transparent cursor-pointer transition"
               onclick="openModal(${item.id})" id="img-${item.id}" />
          <button onclick="addToCart(${item.id}, this)"
                  class="mt-2 bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center mx-auto transition-transform">+</button>
        `;
        container.appendChild(card);
      });
    });

    function toggleCategory(id) {
      document.getElementById(id).classList.toggle('hidden');
    }

    function addToCart(id, btn) {
      const item = [...starterData, ...entreeData, ...dessertData, ...drinkData].find(i => i.id === id);
      if (!cart[id]) {
        cart[id] = { ...item, qty: 1 };
        document.getElementById(`img-${id}`).classList.add('border-red-500');
      } else {
        cart[id].qty += 1;
      }

      const badge = document.getElementById(`badge-${id}`);
      if (cart[id].qty >= 2) {
        badge.textContent = cart[id].qty;
        badge.classList.remove('hidden');
      }

      btn.classList.add('scale-110');
      setTimeout(() => btn.classList.remove('scale-110'), 150);

      updateCartTab();
    }

    function updateCartTab() {
      const total = Object.values(cart).reduce((acc, item) => acc + item.qty, 0);
      const cartTab = document.getElementById('cartTab');
      if (total > 0) {
        cartTab.textContent = `View Cart (${total})`;
        cartTab.classList.remove('bottom-[-4rem]');
        cartTab.classList.add('bottom-4');
      } else {
        cartTab.classList.add('bottom-[-4rem]');
        cartTab.classList.remove('bottom-4');
      }
    }

    function incrementCartItem(id) {
        cart[id].qty += 1;
        updateCartTab();
        openCartDrawer(); // re-render drawer
    }

    function decrementCartItem(id) {
        cart[id].qty -= 1;

        // Remove if 0
        if (cart[id].qty <= 0) {
            delete cart[id];
            document.getElementById(`badge-${id}`)?.classList.add('hidden');
            document.getElementById(`img-${id}`)?.classList.remove('border-red-500');
        } else {
            const badge = document.getElementById(`badge-${id}`);
            if (cart[id].qty >= 2) {
            badge.textContent = cart[id].qty;
            badge.classList.remove('hidden');
            } else {
            badge.classList.add('hidden');
            }
        }

        updateCartTab();

        // Close drawer if cart is empty
        if (Object.keys(cart).length === 0) {
            closeCartDrawer();
        } else {
            openCartDrawer(); // re-render
        }
    }


    function openModal(id) {
      const item = [...starterData, ...entreeData, ...dessertData, ...drinkData].find(i => i.id === id);
      document.getElementById('modalTitle').textContent = item.name;
      document.getElementById('modalDesc').textContent = item.desc;
      document.getElementById('modalPrice').textContent = `$${item.price.toFixed(2)}`;
      document.getElementById('modalImg').src = item.img;
      document.getElementById('modalQty').textContent = cart[id]?.qty || 1;

      const overlay = document.getElementById('modalOverlay');
      const content = document.getElementById('modalContent');

      overlay.classList.remove('hidden');
      overlay.classList.add('flex', 'overlay-fade-in');
      content.classList.remove('fade-out');
      content.classList.add('fade-in');

      overlay.setAttribute('data-current-id', id);
    }

    function hideModal() {
      const overlay = document.getElementById('modalOverlay');
      const content = document.getElementById('modalContent');

      content.classList.remove('fade-in');
      content.classList.add('fade-out');
      overlay.classList.remove('overlay-fade-in');
      overlay.classList.add('overlay-fade-out');

      setTimeout(() => {
        overlay.classList.add('hidden');
        overlay.classList.remove('flex', 'overlay-fade-out');
      }, 200);
    }

    function adjustQty(delta) {
      const qtyEl = document.getElementById('modalQty');
      let count = parseInt(qtyEl.textContent) + delta;
      if (count < 0) count = 0;
      qtyEl.textContent = count;

      const id = parseInt(document.getElementById('modalOverlay').getAttribute('data-current-id'));
      const imgEl = document.getElementById(`img-${id}`);
        if (count >= 1) {
            imgEl.classList.add('border-red-500');
        } else {
            imgEl.classList.remove('border-red-500');
        }

      if (count === 0) {
        delete cart[id];
        document.getElementById(`img-${id}`).classList.remove('border-red-500');
        document.getElementById(`badge-${id}`).classList.add('hidden');
      } else {
        const item = [...starterData, ...entreeData, ...dessertData, ...drinkData].find(i => i.id === id);
        cart[id] = { ...item, qty: count };
        const badge = document.getElementById(`badge-${id}`);
        if (count >= 2) {
          badge.textContent = count;
          badge.classList.remove('hidden');
        } else {
          badge.classList.add('hidden');
        }
      }

      updateCartTab();
    }

    function openCartDrawer() {
        const drawer = document.getElementById('cartDrawer');
        const overlay = document.getElementById('cartDrawerOverlay');

        // Populate cart items
        const content = document.getElementById('cartDrawerContent');
        content.innerHTML = '';
        document.getElementById('clearCartWrapper').classList.toggle('hidden', Object.keys(cart).length === 0);

        let subtotal = 0;

       Object.values(cart).forEach(item => {
            const total = item.qty * item.price;
            subtotal += total;

            const row = document.createElement('div');
            row.className = 'flex justify-between items-center text-sm';

            row.innerHTML = `
                <div class="flex flex-col">
                <div class="font-medium">${item.name}</div>
                <div class="flex items-center gap-2 mt-1">
                    <button onclick="decrementCartItem(${item.id})"
                            class="bg-red-100 text-red-600 px-2 py-1 rounded-full text-sm">–</button>
                    <span>${item.qty}</span>
                    <button onclick="incrementCartItem(${item.id})"
                            class="bg-red-100 text-red-600 px-2 py-1 rounded-full text-sm">+</button>
                </div>
                </div>
                <div class="text-right font-semibold text-gray-700">$${total.toFixed(2)}</div>
                `;

            content.appendChild(row);
        });


        document.getElementById('cartSubtotal').textContent = `$${subtotal.toFixed(2)}`;

        drawer.classList.remove('translate-y-full');
        drawer.classList.add('translate-y-0');
        overlay.classList.remove('hidden');
    }

    function closeCartDrawer() {
    const drawer = document.getElementById('cartDrawer');
    const overlay = document.getElementById('cartDrawerOverlay');
    drawer.classList.remove('translate-y-0');
    drawer.classList.add('translate-y-full');
    overlay.classList.add('hidden');
    }

    function clearCart() {
        Object.keys(cart).forEach(id => {
            document.getElementById(`badge-${id}`)?.classList.add('hidden');
            document.getElementById(`img-${id}`)?.classList.remove('border-red-500');
        });

        for (const key in cart) delete cart[key];

        updateCartTab();
        closeCartDrawer();
    }

    function goToCheckout() {
        // Hide cart drawer
        closeCartDrawer();

        // Hide menu view
        document.getElementById('categories').classList.add('hidden');
        document.getElementById('cartTab').classList.add('hidden');

        // Show checkout view
        document.getElementById('checkoutView').classList.remove('hidden');

        // Build checkout cart view
        const checkoutCart = document.getElementById('checkoutCart');
        checkoutCart.innerHTML = '';

        let subtotal = 0;

        Object.values(cart).forEach(item => {
                const line = document.createElement('div');
                const total = item.qty * item.price;
                subtotal += total;

                line.className = 'flex justify-between items-center';
                line.innerHTML = `
                <div>
                    <div class="font-medium">${item.name}</div>
                    <div class="text-xs text-gray-500">Qty: ${item.qty}</div>
                </div>
                <div class="text-right font-semibold">$${total.toFixed(2)}</div>
                `;

                checkoutCart.appendChild(line);
            });

            document.getElementById('checkoutSubtotal').textContent = `$${subtotal.toFixed(2)}`;
        }

        function returnToMenu() {
        document.getElementById('checkoutView').classList.add('hidden');
        document.getElementById('categories').classList.remove('hidden');
        document.getElementById('cartTab').classList.remove('hidden');
        }


    document.getElementById('modalOverlay').addEventListener('click', hideModal);
        
    document.getElementById('checkoutForm').addEventListener('submit', function (e) {
        e.preventDefault();
        alert("🎉 Order placed! Thank you.");
        returnToMenu();
    });
  
  </script>

  <!-- Cart Drawer -->
<div id="cartDrawerOverlay"
     class="fixed inset-0 bg-black bg-opacity-50 hidden z-40"
     onclick="closeCartDrawer()"></div>

<div id="cartDrawer"
     class="fixed bottom-0 left-0 right-0 bg-white rounded-t-2xl shadow-lg transform translate-y-full transition-transform duration-300 z-50">
  <div class="p-4 flex justify-between items-center border-b">
    <h3 class="text-lg font-semibold">Your Order</h3>
    <button onclick="closeCartDrawer()" class="text-gray-500 text-xl">✕</button>
  </div>
  <div id="cartDrawerContent" class="p-4 space-y-4 max-h-60 overflow-y-auto">
    <!-- Items will be injected here -->
  </div>
  <div id="clearCartWrapper" class="px-4 pb-2">
  <button onclick="clearCart()"
          class="text-sm text-red-500 hover:underline font-medium">
    Clear Cart
  </button>
</div>

  <div class="p-4 border-t">
    <div class="flex justify-between items-center mb-3">
      <span class="font-medium">Subtotal</span>
      <span id="cartSubtotal" class="font-bold text-red-600">$0.00</span>
    </div>
    <button onclick="goToCheckout()"
        class="w-full bg-red-500 text-white py-3 rounded-full font-semibold">
        Checkout
    </button>
  </div>
</div>

<!-- Checkout View (hidden by default) -->
<section id="checkoutView" class="hidden bg-white p-4 max-w-2xl mx-auto rounded-t-2xl shadow-lg z-50">
  <h2 class="text-2xl font-bold text-center mb-6">Checkout</h2>

  <!-- Cart Summary -->
  <div id="checkoutCart" class="space-y-4 text-sm mb-6">
    <!-- Cart items will be injected here -->
  </div>

  <!-- Subtotal -->
  <div class="flex justify-between font-semibold text-md mb-6">
    <span>Subtotal</span>
    <span id="checkoutSubtotal" class="text-red-600">$0.00</span>
  </div>

  <!-- Customer Info -->
  <form id="checkoutForm" class="space-y-4 text-sm">
    <div>
      <label class="block mb-1 font-medium">Name</label>
      <input type="text" required placeholder="John Doe"
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-400">
    </div>
    <div>
      <label class="block mb-1 font-medium">Email</label>
      <input type="email" required placeholder="you@example.com"
             class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-400">
    </div>
    <div class="text-center mt-6">
      <button type="submit"
              class="w-full bg-red-500 text-white py-3 rounded-full font-semibold hover:bg-red-600 transition">
        Submit Order
      </button>
    </div>
  </form>

  <!-- Back Button -->
  <div class="text-center mt-4">
    <button onclick="returnToMenu()"
            class="text-sm text-red-500 hover:underline font-medium">
      ← Back to Menu
    </button>
  </div>
</section>


</body>
</html>
